const LumaAIService = require('../services/lumaAIService');

exports.generateVideo = async (req, res) => {
  const { prompt, model, resolution, duration } = req.body;

  if (!prompt) {
    return res.status(400).json({ error: 'Prompt is required for video generation.' });
  }

  try {
    const videoUrl = await LumaAIService.generateVideo(prompt, model, resolution, duration);
    res.json({ message: 'Video generated successfully', videoUrl });
  } catch (error) {
    console.error('ğŸš¨ Error generating video:', error.message);
    res.status(500).json({ error: error.message });
  }
};

exports.getCredits = async (req, res) => {
  try {
    const credits = await LumaAIService.getCredits();
    res.json({ 
      message: 'CrÃ©dits rÃ©cupÃ©rÃ©s avec succÃ¨s', 
      details: `Il vous reste ${credits.credit_balance} crÃ©dits.` 
    });
  } catch (error) {
    console.error('ğŸš¨ Erreur lors de la rÃ©cupÃ©ration des crÃ©dits:', error.message);
    res.status(500).json({ error: 'Erreur lors de la rÃ©cupÃ©ration des crÃ©dits. Veuillez rÃ©essayer plus tard.' });
  }
};
